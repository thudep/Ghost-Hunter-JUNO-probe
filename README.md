此为 实验物理的大数据方法（2） 课程第二阶段大作业：JUNO probe。

在[一阶段大作业](https://git.tsinghua.edu.cn/physics-data/projects/tpl_junosap)中，我们完成了JUNO探测器的模拟和分析，对JUNO的物理过程有了初步了解，并且通过模拟结果绘制了probe函数的图像。如果你忘了什么是probe函数，请及时回顾，务必明确$r$和$\theta$的定义。

实际上我们第一阶段得到的probe函数只是不含时间的probe（时间维度被积分了），真正的probe函数是需要考虑时间的，也就是说，probe函数应该是$R(r,\theta,t)$，$t$为PE时间。

第二阶段的任务是这样的，我们已经有了足够好的[模拟数据]()，其中`16001.h5~16020.h5`（共20个）是训练集，`problem.h5`是测试集。你需要用这些训练集，得到一个连续可微的含时的probe函数。具体地说，在给定任意顶点坐标、PMT编号以及PE时间的条件下，你需要给出这个PE出现的likelihood值。

每个训练集包含10000个顶点，其格式为：

`ParticleTruth` 表
| 名称      | 说明         | 类型    |
| --------- | ------------ | ------- |
| `EventID` | 事件编号          | `'<i4'` |
| `x`       | 顶点坐标x/mm      | `'<f4'` |
| `y`       | 顶点坐标y/mm      | `'<f4'` |
| `z`       | 顶点坐标z/mm      | `'<f4'` |
| `Ek`      | 顶点动能/MeV      | `'<f4'` |
| `Evis`    | 顶点可见能量/MeV  | `'<f4'` |

注：顶点可见能量是指顶点沉积并且用来发光的能量。

`PETruth` 表
| 名称        | 说明           | 类型    |
| ----------- | -------------- | ------- |
| `EventID`   | 事件编号       | `'<i4'` |
| `ChannelID` | PMT 编号       | `'<i4'` |
| `PETime`    | PE 击中时间/ns | `'<f8'` |

几何文件沿用一阶段的`geo.h5`，其格式为：

`Geometry` 表
| 名称        | 说明                     | 类型    |
| ----------- | ------------------------ | ------- |
| `ChannelID` | PMT 编号                 | `'<u4'` |
| `theta`     | 球坐标 $\theta$ **角度** | `'<f4'` |
| `phi`       | 球坐标 $\phi$ **角度**   | `'<f4'` |

